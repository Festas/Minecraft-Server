openapi: 3.0.3
info:
  title: Minecraft Server Console API
  description: RESTful API for managing Minecraft server, players, plugins, backups, and analytics
  version: 1.0.0
  contact:
    name: Minecraft Server Console
    url: https://github.com/Festas/Minecraft-Server

servers:
  - url: http://localhost:3001/api
    description: Development server
  - url: https://your-server.com/api
    description: Production server

security:
  - ApiKeyAuth: []

components:
  securitySchemes:
    ApiKeyAuth:
      type: http
      scheme: bearer
      bearerFormat: API Key
      description: API key authentication. Format - Authorization: Bearer mcs_your_key_here

  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
        details:
          type: array
          items:
            type: object
      
    ServerStatus:
      type: object
      properties:
        status:
          type: string
          enum: [running, stopped, starting, stopping]
        players:
          type: object
          properties:
            online:
              type: integer
            max:
              type: integer
        cpu:
          type: number
          format: float
        memory:
          type: object
          properties:
            used:
              type: integer
            total:
              type: integer
        uptime:
          type: integer
          description: Server uptime in seconds

    Player:
      type: object
      properties:
        name:
          type: string
        uuid:
          type: string
        online:
          type: boolean

    Plugin:
      type: object
      properties:
        name:
          type: string
        version:
          type: string
        enabled:
          type: boolean

    Backup:
      type: object
      properties:
        name:
          type: string
        size:
          type: integer
        date:
          type: string
          format: date-time

    ApiKey:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        key_prefix:
          type: string
        scopes:
          type: array
          items:
            type: string
        rate_limit_per_hour:
          type: integer
        enabled:
          type: boolean
        created_by:
          type: string
        created_at:
          type: string
          format: date-time
        last_used:
          type: string
          format: date-time
        use_count:
          type: integer

paths:
  # Server Management
  /server/status:
    get:
      summary: Get server status
      description: Get current server status, player count, and resource usage
      tags:
        - Server
      security:
        - ApiKeyAuth: []
      responses:
        '200':
          description: Server status retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServerStatus'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /server/start:
    post:
      summary: Start server
      description: Start the Minecraft server
      tags:
        - Server
      security:
        - ApiKeyAuth: []
      responses:
        '200':
          description: Server starting
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - insufficient permissions

  /server/stop:
    post:
      summary: Stop server
      description: Stop the Minecraft server gracefully
      tags:
        - Server
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                confirmed:
                  type: boolean
              required:
                - confirmed
      responses:
        '200':
          description: Server stopping
        '401':
          description: Unauthorized
        '403':
          description: Forbidden

  /server/restart:
    post:
      summary: Restart server
      description: Restart the Minecraft server
      tags:
        - Server
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                confirmed:
                  type: boolean
              required:
                - confirmed
      responses:
        '200':
          description: Server restarting
        '401':
          description: Unauthorized
        '403':
          description: Forbidden

  # Player Management
  /players:
    get:
      summary: List players
      description: Get list of online players
      tags:
        - Players
      responses:
        '200':
          description: Players retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  players:
                    type: array
                    items:
                      $ref: '#/components/schemas/Player'

  /players/{player}/kick:
    post:
      summary: Kick player
      description: Kick a player from the server
      tags:
        - Players
      parameters:
        - in: path
          name: player
          required: true
          schema:
            type: string
          description: Player name
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
      responses:
        '200':
          description: Player kicked successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden

  /players/{player}/ban:
    post:
      summary: Ban player
      description: Ban a player from the server
      tags:
        - Players
      parameters:
        - in: path
          name: player
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
      responses:
        '200':
          description: Player banned successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden

  # Plugin Management
  /plugins:
    get:
      summary: List plugins
      description: Get list of installed plugins
      tags:
        - Plugins
      responses:
        '200':
          description: Plugins retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  plugins:
                    type: array
                    items:
                      $ref: '#/components/schemas/Plugin'

  /plugins/install:
    post:
      summary: Install plugin
      description: Install a plugin from URL
      tags:
        - Plugins
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                name:
                  type: string
              required:
                - url
      responses:
        '200':
          description: Plugin installed successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden

  # Backup Management
  /backups:
    get:
      summary: List backups
      description: Get list of available backups
      tags:
        - Backups
      responses:
        '200':
          description: Backups retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  backups:
                    type: array
                    items:
                      $ref: '#/components/schemas/Backup'

    post:
      summary: Create backup
      description: Create a new backup
      tags:
        - Backups
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
              required:
                - name
      responses:
        '200':
          description: Backup created successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden

  # Analytics
  /analytics/dashboard:
    get:
      summary: Get dashboard statistics
      description: Get overview dashboard statistics
      tags:
        - Analytics
      parameters:
        - in: query
          name: startDate
          schema:
            type: string
            format: date-time
          description: Start date for statistics
        - in: query
          name: endDate
          schema:
            type: string
            format: date-time
          description: End date for statistics
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  stats:
                    type: object

  # API Key Management
  /api-keys:
    get:
      summary: List API keys
      description: Get list of all API keys
      tags:
        - API Keys
      responses:
        '200':
          description: API keys retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  api_keys:
                    type: array
                    items:
                      $ref: '#/components/schemas/ApiKey'

    post:
      summary: Create API key
      description: Create a new API key
      tags:
        - API Keys
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                scopes:
                  type: array
                  items:
                    type: string
                rate_limit_per_hour:
                  type: integer
                expires_at:
                  type: string
                  format: date-time
              required:
                - name
                - scopes
      responses:
        '201':
          description: API key created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  api_key:
                    allOf:
                      - $ref: '#/components/schemas/ApiKey'
                      - type: object
                        properties:
                          api_key:
                            type: string
                            description: The actual API key (only shown once)
                  warning:
                    type: string

  /api-keys/{id}:
    get:
      summary: Get API key details
      description: Get details of a specific API key
      tags:
        - API Keys
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: API key retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  api_key:
                    $ref: '#/components/schemas/ApiKey'
        '404':
          description: API key not found

    patch:
      summary: Update API key
      description: Update an API key
      tags:
        - API Keys
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                scopes:
                  type: array
                  items:
                    type: string
                enabled:
                  type: boolean
      responses:
        '200':
          description: API key updated successfully
        '404':
          description: API key not found

    delete:
      summary: Revoke API key
      description: Revoke (delete) an API key
      tags:
        - API Keys
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: API key revoked successfully
        '404':
          description: API key not found

  /api-keys/scopes:
    get:
      summary: Get available scopes
      description: Get list of available API scopes
      tags:
        - API Keys
      responses:
        '200':
          description: Scopes retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  scopes:
                    type: array
                    items:
                      type: object
                      properties:
                        scope:
                          type: string
                        description:
                          type: string

  /api-keys/{id}/stats:
    get:
      summary: Get API key usage statistics
      description: Get usage statistics for an API key
      tags:
        - API Keys
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
        - in: query
          name: start_date
          schema:
            type: string
            format: date-time
        - in: query
          name: end_date
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  stats:
                    type: object
                    properties:
                      total_requests:
                        type: integer
                      successful_requests:
                        type: integer
                      failed_requests:
                        type: integer
                      avg_response_time:
                        type: integer
                      max_response_time:
                        type: integer
                      success_rate:
                        type: number
                        format: float

tags:
  - name: Server
    description: Server management endpoints
  - name: Players
    description: Player management endpoints
  - name: Plugins
    description: Plugin management endpoints
  - name: Backups
    description: Backup management endpoints
  - name: Analytics
    description: Analytics and statistics endpoints
  - name: API Keys
    description: API key management endpoints
