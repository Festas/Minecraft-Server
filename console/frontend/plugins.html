<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plugin Manager - Minecraft Server Console</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/console.css">
    <link rel="stylesheet" href="css/minecraft-theme.css">
    <link rel="stylesheet" href="css/theme-light.css">
    <link rel="stylesheet" href="css/accessibility.css">
    <link rel="stylesheet" href="css/plugins.css">
</head>
<body>
    <div class="console-wrapper">
        <!-- Header -->
        <header class="console-header">
            <div class="header-left">
                <h1>üéÆ Festas Builds - Plugin Manager</h1>
            </div>
            <div class="header-right">
                <button id="themeToggle" aria-label="Toggle theme">
                    <span class="theme-icon">‚òÄÔ∏è</span>
                    <span class="theme-text">Light Mode</span>
                </button>
                <span id="currentUser" class="user-badge">Admin</span>
                <button id="logoutBtn" class="btn btn-secondary">Logout</button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="console-layout">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav>
                    <button class="nav-item" data-section="dashboard" data-href="/console/">
                        <span>üìä</span> Dashboard
                    </button>
                    <button class="nav-item" data-section="console" data-href="/console/">
                        <span>üíª</span> Console
                    </button>
                    <button class="nav-item" data-section="players" data-href="/console/">
                        <span>üë•</span> Players
                    </button>
                    <button class="nav-item" data-section="controls" data-href="/console/">
                        <span>‚öôÔ∏è</span> Controls
                    </button>
                    <button class="nav-item" data-section="backups" data-href="/console/">
                        <span>üì¶</span> Backups
                    </button>
                    <button class="nav-item active" data-section="plugins">
                        <span>üîå</span> Plugins
                    </button>
                    <button class="nav-item" data-section="settings" data-href="/console/">
                        <span>üîß</span> Settings
                    </button>
                </nav>
            </aside>

            <!-- Main Content Area -->
            <main class="main-content">
                <!-- Plugin Manager Section -->
                <section id="pluginManager" class="content-section active">
                    <!-- Quick Install -->
                    <div class="card plugin-install-card">
                        <h3>üì¶ Quick Install</h3>
                        <div class="install-form">
                            <div class="form-group">
                                <input 
                                    type="text" 
                                    id="pluginUrl" 
                                    placeholder="Paste plugin URL here (Direct JAR, GitHub release, Modrinth)..." 
                                    class="input url-input"
                                >
                            </div>
                            <div class="form-group">
                                <input 
                                    type="text" 
                                    id="customName" 
                                    placeholder="Custom name (optional - auto-detected from plugin.yml)" 
                                    class="input"
                                >
                            </div>
                            <div class="form-actions">
                                <button id="installBtn" class="btn btn-primary">
                                    ‚¨áÔ∏è Install Plugin
                                </button>
                                <button id="bulkInstallBtn" class="btn btn-secondary">
                                    üìã Bulk Install
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Installed Plugins -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üîå Installed Plugins <span id="pluginCount" class="badge">0</span></h3>
                            <div class="card-actions">
                                <button id="refreshPluginsBtn" class="btn btn-sm">üîÑ Refresh</button>
                            </div>
                        </div>
                        <div id="pluginsList" class="plugins-list">
                            <div class="loading">Loading plugins...</div>
                        </div>
                    </div>

                    <!-- Installation History -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üìú Installation History</h3>
                            <div class="card-actions">
                                <button id="clearHistoryBtn" class="btn btn-sm btn-danger">Clear</button>
                            </div>
                        </div>
                        <div id="historyList" class="history-list">
                            <div class="loading">Loading history...</div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal hidden">
        <div class="modal-content">
            <h3 id="confirmTitle">Confirm Action</h3>
            <p id="confirmMessage">Are you sure?</p>
            <div class="modal-actions">
                <button id="confirmYes" class="btn btn-danger">Confirm</button>
                <button id="confirmNo" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Multi-Option Modal (for GitHub releases with multiple JARs) -->
    <div id="optionsModal" class="modal hidden">
        <div class="modal-content">
            <h3>Select Plugin File</h3>
            <p>Multiple JAR files found. Please select which one to download:</p>
            <div id="optionsList" class="options-list"></div>
            <div class="modal-actions">
                <button id="optionsCancel" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Bulk Install Modal -->
    <div id="bulkModal" class="modal hidden">
        <div class="modal-content modal-large">
            <h3>Bulk Install Plugins</h3>
            <p>Enter one URL per line:</p>
            <textarea id="bulkUrls" rows="10" class="textarea" placeholder="https://example.com/plugin1.jar
https://example.com/plugin2.jar
https://example.com/plugin3.jar"></textarea>
            <div class="modal-actions">
                <button id="bulkInstallStart" class="btn btn-primary">Install All</button>
                <button id="bulkCancel" class="btn btn-secondary">Cancel</button>
            </div>
            <div id="bulkProgress" class="bulk-progress hidden"></div>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Debug Panel (Hidden by default) -->
    <div id="debugPanel" style="position: fixed; bottom: 10px; right: 10px; z-index: 10000;">
        <button id="debugBtn" class="btn btn-sm" style="background: #ff4444; color: white;" title="Show Debug Diagnostics">
            üêõ Debug
        </button>
    </div>

    <!-- Scripts -->
    <script src="js/diagnostics.js"></script>
    <script src="js/themeManager.js"></script>
    <script src="js/accessibility.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/plugins.js"></script>
    <script>
        // Initialize debug button
        document.addEventListener('DOMContentLoaded', function() {
            const debugBtn = document.getElementById('debugBtn');
            if (debugBtn) {
                debugBtn.addEventListener('click', function() {
                    window.PluginManagerDiagnostics.export();
                    
                    // Show download option
                    const shouldDownload = confirm('Diagnostics exported to console. Download as JSON file?');
                    if (shouldDownload) {
                        window.PluginManagerDiagnostics.download();
                    }
                });
            }
        });
    </script>
</body>
</html>
